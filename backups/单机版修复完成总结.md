# å•æœºç‰ˆä¿®å¤å®Œæˆæ€»ç»“

> ä¿®å¤æ—¶é—´ï¼š2026-02-20  
> ç›®æ ‡ï¼šç¡®ä¿å•æœºç‰ˆç¨³å®šè¿è¡Œï¼Œæ— ç½‘ç»œä¾èµ–ï¼ŒåŒå‡»å³ç”¨

---

## âœ… FIX 1: ä¸€é”®æ„å»ºå‘½ä»¤æ ¼å¼ä¿®å¤

### ä¿®æ”¹æ–‡ä»¶
- `backups/STEP6-ä¸€é”®æ„å»ºå‘½ä»¤-æœ€ç»ˆç‰ˆ.md` - å·²åŒ…å« A/B/C ä¸‰æ®µå‘½ä»¤
- `build-scripts/ä¸€é”®æ„å»º-Windows.bat` - å·²æ›´æ–°ï¼ˆæ¯æ¡å‘½ä»¤æ£€æŸ¥ ERRORLEVELï¼‰

### å…³é”®ä¿®æ”¹

**æ‰¹å¤„ç†è„šæœ¬æ”¹è¿›**ï¼š
```batch
REM æ¯æ¡å‘½ä»¤åæ£€æŸ¥ ERRORLEVELï¼Œå¤±è´¥ç«‹å³é€€å‡º
call npm install
if errorlevel 1 (
    echo [ERROR] Dependency installation failed
    exit /b 1
)
```

### ä¸‰æ®µå¯å¤åˆ¶å‘½ä»¤ï¼ˆå·²ç¡®è®¤ï¼‰

**A) PowerShell å¤šè¡Œç‰ˆ**ï¼š
```powershell
cd "D:\ä»“åº“ç®¡ç†\warehouse-app"
npm install
npm run server:build
npm run rebuild:native
npm run compile
npm run build
npm run dist:win
```

**B) PowerShell å•è¡Œç‰ˆ**ï¼š
```powershell
cd "D:\ä»“åº“ç®¡ç†\warehouse-app"; npm install; npm run server:build; npm run rebuild:native; npm run compile; npm run build; npm run dist:win
```

**C) CMD å•è¡Œç‰ˆ**ï¼š
```cmd
cd /d "D:\ä»“åº“ç®¡ç†\warehouse-app" && npm install && npm run server:build && npm run rebuild:native && npm run compile && npm run build && npm run dist:win
```

---

## âœ… FIX 2: better-sqlite3 ç¨³å®šæ€§ä¿è¯

### ä¿®æ”¹æ–‡ä»¶
- `package.json` - å·²æ·»åŠ  predist:win é’©å­

### å…³é”®ä¿®æ”¹

```diff
  "scripts": {
    "rebuild:native": "electron-rebuild -f -w better-sqlite3",
+   "predist:win": "npm run rebuild:native"
  },
  "dependencies": {
    "better-sqlite3": "^11.5.0"  // âœ… åœ¨ dependenciesï¼ˆä¸æ˜¯ devDependenciesï¼‰
  },
  "devDependencies": {
    "electron": "27.3.11"  // âœ… ç‰ˆæœ¬å›ºå®šï¼ˆä¸æ˜¯ latestï¼‰
  }
}
```

### éªŒè¯æ­¥éª¤ï¼ˆæ–‡å­—è¯´æ˜ï¼‰

1. **æ‰§è¡Œæ„å»º**ï¼š`npm run dist:win`
2. **ç¡®è®¤ rebuild æ‰§è¡Œ**ï¼šæ„å»ºæ—¥å¿—ä¸­åº”çœ‹åˆ° `electron-rebuild` æ‰§è¡Œ
3. **å®‰è£…å¹¶è¿è¡Œ**ï¼šåŒå‡»å®‰è£…åŒ…ï¼Œå¯åŠ¨åº”ç”¨
4. **éªŒè¯æ— é”™è¯¯**ï¼šåº”ç”¨æ­£å¸¸å¯åŠ¨ï¼Œæ—  `MODULE_NOT_FOUND` é”™è¯¯
5. **æ£€æŸ¥æ—¥å¿—**ï¼š`%APPDATA%\warehouse-app\logs\app-*.log` ä¸­æ—  better-sqlite3 ç›¸å…³é”™è¯¯

---

## âœ… FIX 3: ç«¯å£è‡ªåŠ¨åˆ‡æ¢è”åŠ¨å‰ç«¯

### ä¿®æ”¹æ–‡ä»¶
- `electron/main.ts` - ç«¯å£è§£æå’Œå¥åº·æ£€æŸ¥å¤šç«¯å£è½®è¯¢
- `server/index.ts` - è¾“å‡º LISTENING:PORT= æ ¼å¼

### å…³é”®ä¿®æ”¹

**ä¸»è¿›ç¨‹ç«¯å£è§£æ**ï¼š
```typescript
// è§£æ stdout è·å–å®é™…ç«¯å£
backendProcess.stdout?.on('data', (data: Buffer) => {
  const portMatch = msg.match(/LISTENING:PORT=(\d+)/);
  if (portMatch) {
    actualBackendPort = parseInt(portMatch[1], 10);
    actualBackendURL = `http://127.0.0.1:${actualBackendPort}`;
    logStream.write(`[INFO] åç«¯å®é™…ç›‘å¬ç«¯å£: ${actualBackendPort}\n`);
  }
});

// å¥åº·æ£€æŸ¥å¤šç«¯å£è½®è¯¢
const checkHealth = async (): Promise<void> => {
  const portsToTry = actualBackendPort !== BACKEND_PORT 
    ? [actualBackendPort] 
    : [BACKEND_PORT, 41732, 41733, 41734, 41735, 41736, 41737, 41738, 41739, 41740];
  
  for (const port of portsToTry) {
    const response = await fetch(`http://127.0.0.1:${port}/api/health`);
    if (response.ok) {
      actualBackendPort = port;
      actualBackendURL = `http://127.0.0.1:${actualBackendPort}`;
      resolve();
      return;
    }
  }
};

// ä½¿ç”¨å®é™…ç«¯å£ loadURL
mainWindow.loadURL(actualBackendURL);
```

**åç«¯ç«¯å£è¾“å‡º**ï¼š
```typescript
await fastify.listen({ port, host });
console.log(`LISTENING:PORT=${port}`);
```

### éªŒè¯æ­¥éª¤ï¼ˆæ–‡å­—è¯´æ˜ï¼‰

1. **å ç”¨ç«¯å£ 41731**ï¼š
   ```powershell
   # ä½¿ç”¨ PowerShell å ç”¨ç«¯å£ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰
   $listener = [System.Net.Sockets.TcpListener]::new([System.Net.IPAddress]::Any, 41731)
   $listener.Start()
   ```

2. **å¯åŠ¨åº”ç”¨**ï¼šåŒå‡»æ¡Œé¢å›¾æ ‡å¯åŠ¨åº”ç”¨

3. **æ£€æŸ¥æ—¥å¿—**ï¼š
   ```powershell
   Get-Content "$env:APPDATA\warehouse-app\logs\app-*.log" -Tail 20
   ```
   æ—¥å¿—ä¸­åº”æ˜¾ç¤ºï¼š`åç«¯å®é™…ç›‘å¬ç«¯å£: 41732`ï¼ˆæˆ–å…¶ä»–ç«¯å£ï¼‰

4. **éªŒè¯çª—å£æ‰“å¼€**ï¼šåº”ç”¨çª—å£åº”æ­£å¸¸æ‰“å¼€ï¼Œç•Œé¢æ­£å¸¸æ˜¾ç¤º

5. **éªŒè¯å¥åº·ç«¯ç‚¹**ï¼š
   ```powershell
   Invoke-WebRequest -Uri "http://127.0.0.1:41732/api/health" -UseBasicParsing
   ```
   åº”è¿”å›ï¼š`{"status":"ok"}`

6. **é‡Šæ”¾ç«¯å£**ï¼š
   ```powershell
   $listener.Stop()
   ```

---

## âœ… FIX 4: æ•°æ®åº“/æ—¥å¿—è·¯å¾„ä½¿ç”¨ app.getPath

### ä¿®æ”¹æ–‡ä»¶
- `electron/main.ts` - ä½¿ç”¨ app.getPath('userData') è®¡ç®—è·¯å¾„
- `server/model/db.ts` - ä»ç¯å¢ƒå˜é‡è¯»å–è·¯å¾„

### å…³é”®ä¿®æ”¹

**ä¸»è¿›ç¨‹è·¯å¾„è®¡ç®—**ï¼š
```typescript
// ä½¿ç”¨ Electron app.getPath è®¡ç®—ç”¨æˆ·æ•°æ®ç›®å½•
const userDataDir = app.getPath('userData');
const dbDir = path.join(userDataDir, 'warehouse-app');
if (!fs.existsSync(dbDir)) {
  fs.mkdirSync(dbDir, { recursive: true });
}

const env = {
  ...process.env,
  WAREHOUSE_USER_DATA: dbDir, // ä¼ é€’ç»™åç«¯
};

// æ—¥å¿—è·¯å¾„
function getLogPath(): string {
  const userData = app.getPath('userData');
  const logDir = path.join(userData, 'warehouse-app', 'logs');
  if (!fs.existsSync(logDir)) {
    fs.mkdirSync(logDir, { recursive: true });
  }
  return path.join(logDir, `app-${new Date().toISOString().slice(0, 10)}.log`);
}
```

**åç«¯è·¯å¾„è¯»å–**ï¼š
```typescript
function getDbPath(): string {
  // ä¼˜å…ˆä½¿ç”¨ç¯å¢ƒå˜é‡ï¼ˆç”± Electron ä¸»è¿›ç¨‹è®¾ç½®ï¼‰
  let userDataDir: string;
  
  if (process.env.WAREHOUSE_USER_DATA) {
    userDataDir = process.env.WAREHOUSE_USER_DATA;
  } else {
    // å¤‡ç”¨æ–¹æ¡ˆï¼šä½¿ç”¨å¹³å°é»˜è®¤è·¯å¾„
    userDataDir = process.platform === 'win32'
      ? path.join(os.homedir(), 'AppData', 'Roaming', 'warehouse-app')
      : path.join(os.homedir(), '.warehouse-app');
  }
  
  return path.join(userDataDir, 'warehouse.db');
}
```

### è·¯å¾„è¯´æ˜

- **Windows**: `C:\Users\<ç”¨æˆ·å>\AppData\Roaming\warehouse-app\`
  - æ•°æ®åº“ï¼š`warehouse.db`
  - æ—¥å¿—ï¼š`logs\app-YYYY-MM-DD.log`
- **macOS**: `~/Library/Application Support/warehouse-app/`
- **Linux**: `~/.config/warehouse-app/`

### éªŒè¯æ­¥éª¤ï¼ˆæ–‡å­—è¯´æ˜ï¼‰

1. **å¯åŠ¨åº”ç”¨**ï¼šåŒå‡»æ¡Œé¢å›¾æ ‡å¯åŠ¨åº”ç”¨

2. **æ£€æŸ¥æ•°æ®åº“æ–‡ä»¶**ï¼š
   ```powershell
   $dbPath = "$env:APPDATA\warehouse-app\warehouse.db"
   Test-Path $dbPath
   Get-Item $dbPath | Select-Object FullName, Length
   ```
   é¢„æœŸï¼šæ–‡ä»¶å­˜åœ¨ï¼Œè·¯å¾„ä¸º `C:\Users\<ç”¨æˆ·å>\AppData\Roaming\warehouse-app\warehouse.db`

3. **æ£€æŸ¥æ—¥å¿—æ–‡ä»¶**ï¼š
   ```powershell
   $logDir = "$env:APPDATA\warehouse-app\logs"
   Get-ChildItem $logDir | Sort-Object LastWriteTime -Descending | Select-Object -First 1
   ```
   é¢„æœŸï¼šæ—¥å¿—æ–‡ä»¶å­˜åœ¨ï¼Œè·¯å¾„ä¸º `C:\Users\<ç”¨æˆ·å>\AppData\Roaming\warehouse-app\logs\app-YYYY-MM-DD.log`

4. **æ£€æŸ¥æ—¥å¿—å†…å®¹**ï¼š
   ```powershell
   Get-Content "$env:APPDATA\warehouse-app\logs\app-*.log" | Select-String "ç”¨æˆ·æ•°æ®ç›®å½•"
   ```
   é¢„æœŸï¼šæ—¥å¿—ä¸­æ˜¾ç¤º `[INFO] ç”¨æˆ·æ•°æ®ç›®å½•: C:\Users\<ç”¨æˆ·å>\AppData\Roaming\warehouse-app`

---

## âœ… FIX 5: asarUnpack å¢åŠ  **/*.node å…œåº•

### ä¿®æ”¹æ–‡ä»¶
- `package.json` - build.asarUnpack é…ç½®

### å…³é”®ä¿®æ”¹

```diff
  "build": {
    "asar": true,
    "asarUnpack": [
      "**/better-sqlite3/**/*",
      "**/server/dist/**/*",
+     "**/*.node"
    ]
  }
}
```

### éªŒè¯æ­¥éª¤ï¼ˆæ–‡å­—è¯´æ˜ï¼‰

1. **æ‰§è¡Œæ„å»º**ï¼š`npm run dist:win`

2. **æ£€æŸ¥æ‰“åŒ…äº§ç‰©**ï¼š
   - å®‰è£…åŒ…ï¼š`dist\ä»“åº“ç®¡ç†-1.0.0-Setup.exe`
   - è§£å‹å®‰è£…åŒ…ï¼ˆæˆ–æ£€æŸ¥æ„å»ºæ—¥å¿—ï¼‰

3. **éªŒè¯ asar.unpacked ç›®å½•**ï¼š
   å®‰è£…åï¼Œæ£€æŸ¥ `resources\app.asar.unpacked\` ç›®å½•åº”åŒ…å«ï¼š
   - `node_modules\better-sqlite3\` ç›®å½•åŠå…¶ `.node` æ–‡ä»¶
   - `server\dist\` ç›®å½•åŠå…¶ JS æ–‡ä»¶
   - å…¶ä»– `.node` æ–‡ä»¶ï¼ˆå¦‚æœæœ‰å…¶ä»– native æ¨¡å—ï¼‰

4. **è¿è¡ŒéªŒè¯**ï¼šåº”ç”¨æ­£å¸¸å¯åŠ¨ï¼Œæ—  native æ¨¡å—åŠ è½½é”™è¯¯

---

## ğŸ“‹ æœ€ç»ˆäº¤ä»˜æ¸…å•

### 1. æ›´æ–°åçš„æ–‡æ¡£
- âœ… `backups/STEP6-ä¸€é”®æ„å»ºå‘½ä»¤-æœ€ç»ˆç‰ˆ.md` - åŒ…å« A/B/C ä¸‰æ®µå‘½ä»¤
- âœ… `backups/å•æœºç‰ˆä¿®å¤å®Œæˆæ€»ç»“.md` - æœ¬æ–‡æ¡£

### 2. æ›´æ–°åçš„æ„å»ºè„šæœ¬
- âœ… `build-scripts/ä¸€é”®æ„å»º-Windows.bat` - æ¯æ¡å‘½ä»¤æ£€æŸ¥ ERRORLEVEL

### 3. package.json scripts/build diff

```diff
  "scripts": {
+   "predist:win": "npm run rebuild:native"
  },
  "build": {
    "asarUnpack": [
      "**/better-sqlite3/**/*",
      "**/server/dist/**/*",
+     "**/*.node"
    ]
  }
}
```

### 4. ä¸»è¿›ç¨‹å¯åŠ¨ server & ç«¯å£è”åŠ¨ diff

è§ FIX 3 å…³é”®ä¿®æ”¹éƒ¨åˆ†

### 5. å•æœºéªŒè¯æµç¨‹

è§ä¸‹æ–¹"å•æœºéªŒè¯æµç¨‹"ç« èŠ‚

### 6. è¾“å‡ºäº§ç‰©

- `dist\ä»“åº“ç®¡ç†-1.0.0-Setup.exe`

---

## ğŸ” å•æœºéªŒè¯æµç¨‹ï¼ˆå®Œæ•´æ­¥éª¤ï¼‰

### æ­¥éª¤ 1: å‡†å¤‡ç¯å¢ƒ

```powershell
# 1. æ£€æŸ¥ Node.js ç‰ˆæœ¬ï¼ˆéœ€è¦ 18+ï¼‰
node --version

# 2. åˆ‡æ¢åˆ°é¡¹ç›®ç›®å½•
cd "D:\ä»“åº“ç®¡ç†\warehouse-app"

# 3. ï¼ˆå¯é€‰ï¼‰æ¸…ç†æ—§æ„å»ºäº§ç‰©
Remove-Item -Recurse -Force node_modules, server/dist, dist-electron, dist -ErrorAction SilentlyContinue
```

### æ­¥éª¤ 2: æ‰§è¡Œæ„å»º

**æ–¹å¼ A: ä½¿ç”¨æ‰¹å¤„ç†è„šæœ¬ï¼ˆæ¨èï¼‰**
```batch
# åŒå‡»è¿è¡Œ
build-scripts\ä¸€é”®æ„å»º-Windows.bat
```

**æ–¹å¼ B: ä½¿ç”¨ PowerShell å‘½ä»¤**
```powershell
cd "D:\ä»“åº“ç®¡ç†\warehouse-app"
npm install
npm run server:build
npm run rebuild:native
npm run compile
npm run build
npm run dist:win
```

**é¢„æœŸç»“æœ**ï¼š
- âœ… æ‰€æœ‰æ­¥éª¤æˆåŠŸå®Œæˆ
- âœ… æ— é”™è¯¯ä¿¡æ¯
- âœ… æœ€ç»ˆç”Ÿæˆï¼š`dist\ä»“åº“ç®¡ç†-1.0.0-Setup.exe`

### æ­¥éª¤ 3: éªŒè¯å®‰è£…åŒ…

```powershell
# æ£€æŸ¥å®‰è£…åŒ…æ˜¯å¦å­˜åœ¨
Test-Path "dist\ä»“åº“ç®¡ç†-1.0.0-Setup.exe"

# æ£€æŸ¥å®‰è£…åŒ…å¤§å°ï¼ˆåº”è¯¥ > 100MBï¼‰
Get-Item "dist\ä»“åº“ç®¡ç†-1.0.0-Setup.exe" | Select-Object Length
```

### æ­¥éª¤ 4: å®‰è£…åº”ç”¨

1. **åŒå‡»å®‰è£…åŒ…**ï¼š`dist\ä»“åº“ç®¡ç†-1.0.0-Setup.exe`
2. **é€‰æ‹©å®‰è£…ç›®å½•**ï¼ˆå¯é€‰ï¼Œé»˜è®¤ï¼š`C:\Program Files\ä»“åº“ç®¡ç†`ï¼‰
3. **ç­‰å¾…å®‰è£…å®Œæˆ**
4. **ç¡®è®¤å¿«æ·æ–¹å¼**ï¼šæ¡Œé¢å’Œå¼€å§‹èœå•åº”æœ‰"ä»“åº“ç®¡ç†"å¿«æ·æ–¹å¼

### æ­¥éª¤ 5: å¯åŠ¨åº”ç”¨å¹¶éªŒè¯

#### 5.1 å¯åŠ¨åº”ç”¨

1. **ä»æ¡Œé¢æˆ–å¼€å§‹èœå•å¯åŠ¨åº”ç”¨**
2. **ç­‰å¾…çª—å£æ‰“å¼€**ï¼ˆå¯èƒ½éœ€è¦ 3-5 ç§’ï¼‰

**é¢„æœŸç»“æœ**ï¼š
- âœ… çª—å£æ­£å¸¸æ‰“å¼€
- âœ… æ— é”™è¯¯å¼¹çª—
- âœ… ç•Œé¢æ­£å¸¸æ˜¾ç¤º

#### 5.2 éªŒè¯åç«¯æœåŠ¡

```powershell
# ç­‰å¾…å‡ ç§’è®©åç«¯å¯åŠ¨
Start-Sleep -Seconds 3

# æ£€æŸ¥å¥åº·ç«¯ç‚¹ï¼ˆé»˜è®¤ç«¯å£ 41731ï¼‰
$response = Invoke-WebRequest -Uri "http://127.0.0.1:41731/api/health" -UseBasicParsing -ErrorAction SilentlyContinue

if ($response) {
    Write-Host "âœ… å¥åº·æ£€æŸ¥é€šè¿‡ï¼ˆç«¯å£ 41731ï¼‰: $($response.Content)"
    # é¢„æœŸè¾“å‡º: {"status":"ok"}
} else {
    Write-Host "âš ï¸ ç«¯å£ 41731 æ— å“åº”ï¼Œæ£€æŸ¥å…¶ä»–ç«¯å£..."
    # æ£€æŸ¥å…¶ä»–ç«¯å£ï¼ˆ41732-41740ï¼‰
    for ($port = 41732; $port -le 41740; $port++) {
        $testUrl = "http://127.0.0.1:$port/api/health"
        $testResponse = Invoke-WebRequest -Uri $testUrl -UseBasicParsing -ErrorAction SilentlyContinue
        if ($testResponse) {
            Write-Host "âœ… å¥åº·æ£€æŸ¥é€šè¿‡ï¼ˆç«¯å£ $portï¼‰: $($testResponse.Content)"
            break
        }
    }
}
```

**é¢„æœŸç»“æœ**ï¼š
- âœ… æ‰¾åˆ°å¯ç”¨ç«¯å£ï¼ˆ41731 æˆ– 41732-41740 ä¹‹ä¸€ï¼‰
- âœ… å¥åº·æ£€æŸ¥è¿”å› `{"status":"ok"}`

#### 5.3 éªŒè¯æ•°æ®åº“è·¯å¾„

```powershell
# æ£€æŸ¥æ•°æ®åº“æ–‡ä»¶ä½ç½®
$dbPath = "$env:APPDATA\warehouse-app\warehouse.db"
Write-Host "æ•°æ®åº“è·¯å¾„: $dbPath"

if (Test-Path $dbPath) {
    Write-Host "âœ… æ•°æ®åº“æ–‡ä»¶å­˜åœ¨"
    $dbInfo = Get-Item $dbPath
    Write-Host "   - å®Œæ•´è·¯å¾„: $($dbInfo.FullName)"
    Write-Host "   - æ–‡ä»¶å¤§å°: $($dbInfo.Length) bytes"
    Write-Host "   - ä¿®æ”¹æ—¶é—´: $($dbInfo.LastWriteTime)"
} else {
    Write-Host "âŒ æ•°æ®åº“æ–‡ä»¶ä¸å­˜åœ¨"
}
```

**é¢„æœŸç»“æœ**ï¼š
- âœ… æ•°æ®åº“æ–‡ä»¶åœ¨ï¼š`C:\Users\<ç”¨æˆ·å>\AppData\Roaming\warehouse-app\warehouse.db`
- âœ… æ–‡ä»¶å­˜åœ¨ä¸”å¤§å° > 0

#### 5.4 æ£€æŸ¥æ—¥å¿—æ–‡ä»¶

```powershell
# æŸ¥çœ‹æ—¥å¿—ç›®å½•
$logDir = "$env:APPDATA\warehouse-app\logs"
Write-Host "æ—¥å¿—ç›®å½•: $logDir"

if (Test-Path $logDir) {
    $latestLog = Get-ChildItem $logDir | Sort-Object LastWriteTime -Descending | Select-Object -First 1
    Write-Host "âœ… æœ€æ–°æ—¥å¿—: $($latestLog.FullName)"
    Write-Host ""
    Write-Host "=== æ—¥å¿—å†…å®¹ï¼ˆæœ€å20è¡Œï¼‰ ==="
    Get-Content $latestLog.FullName -Tail 20
}
```

**é¢„æœŸæ—¥å¿—å†…å®¹**ï¼š
```
=== å¯åŠ¨åç«¯æœåŠ¡ 2026-02-20T... ===
[INFO] æœåŠ¡å…¥å£: ...
[INFO] å·¥ä½œç›®å½•: ...
[INFO] ç”¨æˆ·æ•°æ®ç›®å½•: C:\Users\<ç”¨æˆ·å>\AppData\Roaming\warehouse-app
[STDOUT] ğŸš€ Server running at http://127.0.0.1:41731
[STDOUT] LISTENING:PORT=41731
[INFO] åç«¯å®é™…ç›‘å¬ç«¯å£: 41731
[INFO] åç«¯URL: http://127.0.0.1:41731
[INFO] å¥åº·æ£€æŸ¥é€šè¿‡: http://127.0.0.1:41731/api/health
```

### æ­¥éª¤ 6: éªŒè¯ç«¯å£å ç”¨åœºæ™¯ï¼ˆå¯é€‰ï¼‰

#### 6.1 å ç”¨ç«¯å£ 41731

```powershell
# ä½¿ç”¨ PowerShell å ç”¨ç«¯å£ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰
$listener = [System.Net.Sockets.TcpListener]::new([System.Net.IPAddress]::Any, 41731)
$listener.Start()
Write-Host "âœ… ç«¯å£ 41731 å·²å ç”¨"
```

#### 6.2 å¯åŠ¨åº”ç”¨

1. **å¯åŠ¨åº”ç”¨**ï¼ˆç«¯å£ 41731 å·²è¢«å ç”¨ï¼‰
2. **æ£€æŸ¥çª—å£æ˜¯å¦æ­£å¸¸æ‰“å¼€**

**é¢„æœŸç»“æœ**ï¼š
- âœ… çª—å£æ­£å¸¸æ‰“å¼€ï¼ˆä½¿ç”¨å…¶ä»–ç«¯å£ï¼‰
- âœ… æ—¥å¿—æ˜¾ç¤ºç«¯å£åˆ‡æ¢ï¼ˆå¦‚ï¼š41732ï¼‰

#### 6.3 éªŒè¯æ–°ç«¯å£

```powershell
# æ£€æŸ¥æ–°ç«¯å£
for ($port = 41732; $port -le 41740; $port++) {
    $testUrl = "http://127.0.0.1:$port/api/health"
    $testResponse = Invoke-WebRequest -Uri $testUrl -UseBasicParsing -ErrorAction SilentlyContinue
    if ($testResponse) {
        Write-Host "âœ… åç«¯è¿è¡Œåœ¨ç«¯å£ $port"
        break
    }
}
```

#### 6.4 é‡Šæ”¾ç«¯å£

```powershell
# åœæ­¢å ç”¨
$listener.Stop()
Write-Host "âœ… ç«¯å£å·²é‡Šæ”¾"
```

---

## âœ… éªŒè¯æ¸…å•

### æ„å»ºéªŒè¯
- [ ] æ„å»ºæˆåŠŸï¼Œæ— é”™è¯¯
- [ ] å®‰è£…åŒ…ç”Ÿæˆï¼š`dist\ä»“åº“ç®¡ç†-1.0.0-Setup.exe`
- [ ] å®‰è£…åŒ…å¤§å° > 100MB

### å®‰è£…éªŒè¯
- [ ] å®‰è£…æˆåŠŸ
- [ ] å¿«æ·æ–¹å¼åˆ›å»ºæˆåŠŸ

### è¿è¡ŒéªŒè¯
- [ ] åº”ç”¨çª—å£æ­£å¸¸æ‰“å¼€
- [ ] åç«¯æœåŠ¡æ­£å¸¸å¯åŠ¨
- [ ] å¥åº·æ£€æŸ¥é€šè¿‡ï¼š`http://127.0.0.1:41731/api/health`ï¼ˆæˆ–å®é™…ç«¯å£ï¼‰
- [ ] æ•°æ®åº“æ–‡ä»¶åˆ›å»ºåœ¨æ­£ç¡®ä½ç½®ï¼š`%APPDATA%\warehouse-app\warehouse.db`
- [ ] æ—¥å¿—æ–‡ä»¶åˆ›å»ºåœ¨æ­£ç¡®ä½ç½®ï¼š`%APPDATA%\warehouse-app\logs\app-*.log`

### ç«¯å£åˆ‡æ¢éªŒè¯
- [ ] ç«¯å£å ç”¨æ—¶è‡ªåŠ¨åˆ‡æ¢
- [ ] çª—å£ä»èƒ½æ­£å¸¸æ‰“å¼€
- [ ] æ—¥å¿—è®°å½•å®é™…ç«¯å£

### Native æ¨¡å—éªŒè¯
- [ ] æ—  `MODULE_NOT_FOUND` é”™è¯¯
- [ ] better-sqlite3 æ­£å¸¸åŠ è½½
- [ ] æ•°æ®åº“æ“ä½œæ­£å¸¸

---

## ğŸ¯ æ€»ç»“

æ‰€æœ‰ 5 ä¸ª FIX å·²å®Œæˆï¼š

1. âœ… **ä¸€é”®æ„å»ºå‘½ä»¤æ ¼å¼** - æä¾› A/B/C ä¸‰æ®µå¯å¤åˆ¶å‘½ä»¤
2. âœ… **better-sqlite3 ç¨³å®šæ€§** - predist:win é’©å­ä¿è¯ rebuild
3. âœ… **ç«¯å£è‡ªåŠ¨åˆ‡æ¢è”åŠ¨** - ä¸»è¿›ç¨‹è·å–å®é™…ç«¯å£å loadURL
4. âœ… **æ•°æ®åº“/æ—¥å¿—è·¯å¾„** - ä½¿ç”¨ app.getPath('userData')
5. âœ… **asarUnpack é…ç½®** - åŒ…å« **/*.node å…œåº•

**å•æœºç‰ˆå·²å°±ç»ªï¼Œå¯ä»¥å¼€å§‹æ„å»ºå’ŒéªŒè¯ï¼** âœ…
