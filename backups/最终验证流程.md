# æœ€ç»ˆéªŒè¯æµç¨‹ - å¹²å‡€ Windows ç¯å¢ƒ

> ç”Ÿæˆæ—¶é—´ï¼š2026-02-20  
> ç›®æ ‡ï¼šæä¾›å®Œæ•´çš„éªŒè¯æ­¥éª¤ï¼Œç¡®ä¿æ‰€æœ‰ä¿®å¤ç”Ÿæ•ˆ

---

## éªŒè¯ç¯å¢ƒè¦æ±‚

- Windows 10/11 x64
- Node.js 18+ å·²å®‰è£…
- è‡³å°‘ 1GB å¯ç”¨ç£ç›˜ç©ºé—´

---

## æ­¥éª¤ 1: å‡†å¤‡ç¯å¢ƒ

```powershell
# 1. æ£€æŸ¥ Node.js ç‰ˆæœ¬
node --version
# é¢„æœŸè¾“å‡º: v18.x.x æˆ–æ›´é«˜

# 2. æ£€æŸ¥ npm ç‰ˆæœ¬
npm --version
# é¢„æœŸè¾“å‡º: 9.x.x æˆ–æ›´é«˜

# 3. åˆ‡æ¢åˆ°é¡¹ç›®ç›®å½•
cd "D:\ä»“åº“ç®¡ç†\warehouse-app"

# 4. ï¼ˆå¯é€‰ï¼‰æ¸…ç†æ—§æ„å»ºäº§ç‰©
Remove-Item -Recurse -Force node_modules, server/dist, dist-electron, dist -ErrorAction SilentlyContinue
```

---

## æ­¥éª¤ 2: æ‰§è¡Œæ„å»º

### æ–¹å¼ A: ä½¿ç”¨æ‰¹å¤„ç†è„šæœ¬ï¼ˆæ¨èï¼‰

```batch
# åŒå‡»è¿è¡Œ
build-scripts\ä¸€é”®æ„å»º-Windows.bat
```

### æ–¹å¼ B: ä½¿ç”¨ PowerShell å‘½ä»¤

```powershell
cd "D:\ä»“åº“ç®¡ç†\warehouse-app"
npm install
npm run server:build
npm run rebuild:native
npm run compile
npm run build
npm run dist:win
```

**é¢„æœŸè¾“å‡º**ï¼š
- âœ… æ‰€æœ‰æ­¥éª¤æˆåŠŸå®Œæˆ
- âœ… æ— é”™è¯¯ä¿¡æ¯
- âœ… æœ€ç»ˆç”Ÿæˆï¼š`dist\ä»“åº“ç®¡ç†-1.0.0-Setup.exe`

---

## æ­¥éª¤ 3: éªŒè¯å®‰è£…åŒ…

```powershell
# æ£€æŸ¥å®‰è£…åŒ…æ˜¯å¦å­˜åœ¨
Test-Path "dist\ä»“åº“ç®¡ç†-1.0.0-Setup.exe"
# é¢„æœŸè¾“å‡º: True

# æ£€æŸ¥å®‰è£…åŒ…å¤§å°ï¼ˆåº”è¯¥ > 100MBï¼‰
Get-Item "dist\ä»“åº“ç®¡ç†-1.0.0-Setup.exe" | Select-Object Length
# é¢„æœŸè¾“å‡º: Length > 100000000 (100MB)
```

---

## æ­¥éª¤ 4: å®‰è£…åº”ç”¨

1. **åŒå‡»å®‰è£…åŒ…**ï¼š`dist\ä»“åº“ç®¡ç†-1.0.0-Setup.exe`
2. **é€‰æ‹©å®‰è£…ç›®å½•**ï¼ˆå¯é€‰ï¼Œé»˜è®¤ï¼š`C:\Program Files\ä»“åº“ç®¡ç†`ï¼‰
3. **ç­‰å¾…å®‰è£…å®Œæˆ**
4. **ç¡®è®¤å¿«æ·æ–¹å¼**ï¼šæ¡Œé¢å’Œå¼€å§‹èœå•åº”æœ‰"ä»“åº“ç®¡ç†"å¿«æ·æ–¹å¼

---

## æ­¥éª¤ 5: å¯åŠ¨åº”ç”¨å¹¶éªŒè¯

### 5.1 å¯åŠ¨åº”ç”¨

1. **ä»æ¡Œé¢æˆ–å¼€å§‹èœå•å¯åŠ¨åº”ç”¨**
2. **ç­‰å¾…çª—å£æ‰“å¼€**ï¼ˆå¯èƒ½éœ€è¦ 3-5 ç§’ï¼‰

**é¢„æœŸç»“æœ**ï¼š
- âœ… çª—å£æ­£å¸¸æ‰“å¼€
- âœ… æ— é”™è¯¯å¼¹çª—
- âœ… ç•Œé¢æ­£å¸¸æ˜¾ç¤º

### 5.2 éªŒè¯åç«¯æœåŠ¡ï¼ˆæ­£å¸¸ç«¯å£ï¼‰

```powershell
# ç­‰å¾…å‡ ç§’è®©åç«¯å¯åŠ¨
Start-Sleep -Seconds 3

# æ£€æŸ¥å¥åº·ç«¯ç‚¹
$response = Invoke-WebRequest -Uri "http://127.0.0.1:41731/api/health" -UseBasicParsing -ErrorAction SilentlyContinue

if ($response) {
    Write-Host "âœ… å¥åº·æ£€æŸ¥é€šè¿‡ï¼ˆç«¯å£ 41731ï¼‰: $($response.Content)"
    # é¢„æœŸè¾“å‡º: {"status":"ok"}
} else {
    Write-Host "âš ï¸ ç«¯å£ 41731 æ— å“åº”ï¼Œæ£€æŸ¥å…¶ä»–ç«¯å£..."
}
```

### 5.3 éªŒè¯åç«¯æœåŠ¡ï¼ˆç«¯å£åˆ‡æ¢åœºæ™¯ï¼‰

å¦‚æœç«¯å£ 41731 è¢«å ç”¨ï¼Œåç«¯ä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°å…¶ä»–ç«¯å£ï¼š

```powershell
# æ£€æŸ¥å…¶ä»–ç«¯å£ï¼ˆ41732-41740ï¼‰
$found = $false
for ($port = 41732; $port -le 41740; $port++) {
    $testUrl = "http://127.0.0.1:$port/api/health"
    $testResponse = Invoke-WebRequest -Uri $testUrl -UseBasicParsing -ErrorAction SilentlyContinue
    if ($testResponse) {
        Write-Host "âœ… å¥åº·æ£€æŸ¥é€šè¿‡ï¼ˆç«¯å£ $portï¼‰: $($testResponse.Content)"
        $found = $true
        break
    }
}

if (-not $found) {
    Write-Host "âŒ æœªæ‰¾åˆ°åç«¯æœåŠ¡ï¼Œæ£€æŸ¥æ—¥å¿—..."
}
```

**é¢„æœŸç»“æœ**ï¼š
- âœ… æ‰¾åˆ°å¯ç”¨ç«¯å£ï¼ˆ41731 æˆ– 41732-41740 ä¹‹ä¸€ï¼‰
- âœ… å¥åº·æ£€æŸ¥è¿”å› `{"status":"ok"}`
- âœ… çª—å£ä»èƒ½æ­£å¸¸æ‰“å¼€ï¼ˆå³ä½¿ç«¯å£åˆ‡æ¢ï¼‰

---

## æ­¥éª¤ 6: éªŒè¯æ•°æ®åº“è·¯å¾„

```powershell
# æ£€æŸ¥æ•°æ®åº“æ–‡ä»¶ä½ç½®
$dbPath = "$env:APPDATA\warehouse-app\warehouse.db"
Write-Host "æ•°æ®åº“è·¯å¾„: $dbPath"

if (Test-Path $dbPath) {
    Write-Host "âœ… æ•°æ®åº“æ–‡ä»¶å­˜åœ¨"
    $dbInfo = Get-Item $dbPath
    Write-Host "   - å®Œæ•´è·¯å¾„: $($dbInfo.FullName)"
    Write-Host "   - æ–‡ä»¶å¤§å°: $($dbInfo.Length) bytes"
    Write-Host "   - ä¿®æ”¹æ—¶é—´: $($dbInfo.LastWriteTime)"
} else {
    Write-Host "âŒ æ•°æ®åº“æ–‡ä»¶ä¸å­˜åœ¨"
    Write-Host "   æ£€æŸ¥ç›®å½•: $env:APPDATA\warehouse-app"
    if (Test-Path "$env:APPDATA\warehouse-app") {
        Get-ChildItem "$env:APPDATA\warehouse-app" -Recurse
    }
}
```

**é¢„æœŸç»“æœ**ï¼š
- âœ… æ•°æ®åº“æ–‡ä»¶åœ¨ï¼š`C:\Users\<ç”¨æˆ·å>\AppData\Roaming\warehouse-app\warehouse.db`
- âœ… æ–‡ä»¶å­˜åœ¨ä¸”å¤§å° > 0

---

## æ­¥éª¤ 7: æ£€æŸ¥æ—¥å¿—æ–‡ä»¶

```powershell
# æŸ¥çœ‹æ—¥å¿—ç›®å½•
$logDir = "$env:APPDATA\warehouse-app\logs"
Write-Host "æ—¥å¿—ç›®å½•: $logDir"

if (Test-Path $logDir) {
    $latestLog = Get-ChildItem $logDir | Sort-Object LastWriteTime -Descending | Select-Object -First 1
    Write-Host "âœ… æœ€æ–°æ—¥å¿—: $($latestLog.FullName)"
    Write-Host ""
    Write-Host "=== æ—¥å¿—å†…å®¹ï¼ˆæœ€å20è¡Œï¼‰ ==="
    Get-Content $latestLog.FullName -Tail 20
} else {
    Write-Host "âŒ æ—¥å¿—ç›®å½•ä¸å­˜åœ¨"
}
```

**é¢„æœŸæ—¥å¿—å†…å®¹**ï¼š
```
=== å¯åŠ¨åç«¯æœåŠ¡ 2026-02-20T... ===
[INFO] æœåŠ¡å…¥å£: ...
[INFO] å·¥ä½œç›®å½•: ...
[INFO] ç”¨æˆ·æ•°æ®ç›®å½•: C:\Users\<ç”¨æˆ·å>\AppData\Roaming\warehouse-app
[STDOUT] ğŸš€ Server running at http://127.0.0.1:41731
[STDOUT] LISTENING:PORT=41731
[INFO] åç«¯å®é™…ç›‘å¬ç«¯å£: 41731
[INFO] åç«¯URL: http://127.0.0.1:41731
[INFO] å¥åº·æ£€æŸ¥é€šè¿‡: http://127.0.0.1:41731/api/health
```

---

## æ­¥éª¤ 8: éªŒè¯ç«¯å£å ç”¨åœºæ™¯ï¼ˆå¯é€‰ï¼‰

### 8.1 å ç”¨ç«¯å£ 41731

```powershell
# ä½¿ç”¨ PowerShell å ç”¨ç«¯å£ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰
$listener = [System.Net.Sockets.TcpListener]::new([System.Net.IPAddress]::Any, 41731)
$listener.Start()
Write-Host "âœ… ç«¯å£ 41731 å·²å ç”¨"
```

### 8.2 å¯åŠ¨åº”ç”¨

1. **å¯åŠ¨åº”ç”¨**ï¼ˆç«¯å£ 41731 å·²è¢«å ç”¨ï¼‰
2. **æ£€æŸ¥çª—å£æ˜¯å¦æ­£å¸¸æ‰“å¼€**

**é¢„æœŸç»“æœ**ï¼š
- âœ… çª—å£æ­£å¸¸æ‰“å¼€ï¼ˆä½¿ç”¨å…¶ä»–ç«¯å£ï¼‰
- âœ… æ—¥å¿—æ˜¾ç¤ºç«¯å£åˆ‡æ¢ï¼ˆå¦‚ï¼š41732ï¼‰

### 8.3 éªŒè¯æ–°ç«¯å£

```powershell
# æ£€æŸ¥æ–°ç«¯å£
for ($port = 41732; $port -le 41740; $port++) {
    $testUrl = "http://127.0.0.1:$port/api/health"
    $testResponse = Invoke-WebRequest -Uri $testUrl -UseBasicParsing -ErrorAction SilentlyContinue
    if ($testResponse) {
        Write-Host "âœ… åç«¯è¿è¡Œåœ¨ç«¯å£ $port"
        break
    }
}
```

### 8.4 é‡Šæ”¾ç«¯å£

```powershell
# åœæ­¢å ç”¨
$listener.Stop()
Write-Host "âœ… ç«¯å£å·²é‡Šæ”¾"
```

---

## æ­¥éª¤ 9: éªŒè¯å¸è½½ä¿ç•™æ•°æ®

### 9.1 å¸è½½åº”ç”¨

1. **æ‰“å¼€"è®¾ç½®" > "åº”ç”¨"**
2. **æ‰¾åˆ°"ä»“åº“ç®¡ç†"**
3. **ç‚¹å‡»"å¸è½½"**
4. **ç¡®è®¤å¸è½½**

### 9.2 éªŒè¯æ•°æ®ä¿ç•™

```powershell
# æ£€æŸ¥ç”¨æˆ·æ•°æ®ç›®å½•æ˜¯å¦ä¿ç•™
$userDataDir = "$env:APPDATA\warehouse-app"
if (Test-Path $userDataDir) {
    Write-Host "âœ… ç”¨æˆ·æ•°æ®ç›®å½•ä¿ç•™: $userDataDir"
    Get-ChildItem $userDataDir -Recurse | Select-Object FullName, Length
} else {
    Write-Host "âŒ ç”¨æˆ·æ•°æ®ç›®å½•è¢«åˆ é™¤ï¼ˆä¸åº”è¯¥å‘ç”Ÿï¼‰"
}
```

**é¢„æœŸç»“æœ**ï¼š
- âœ… ç”¨æˆ·æ•°æ®ç›®å½•ä¿ç•™
- âœ… æ•°æ®åº“æ–‡ä»¶ä¿ç•™
- âœ… æ—¥å¿—æ–‡ä»¶ä¿ç•™

---

## éªŒè¯æ¸…å•æ€»ç»“

### âœ… æ„å»ºéªŒè¯
- [ ] æ„å»ºæˆåŠŸï¼Œæ— é”™è¯¯
- [ ] å®‰è£…åŒ…ç”Ÿæˆï¼š`dist\ä»“åº“ç®¡ç†-1.0.0-Setup.exe`
- [ ] å®‰è£…åŒ…å¤§å° > 100MB

### âœ… å®‰è£…éªŒè¯
- [ ] å®‰è£…æˆåŠŸ
- [ ] å¿«æ·æ–¹å¼åˆ›å»ºæˆåŠŸ

### âœ… è¿è¡ŒéªŒè¯
- [ ] åº”ç”¨çª—å£æ­£å¸¸æ‰“å¼€
- [ ] åç«¯æœåŠ¡æ­£å¸¸å¯åŠ¨
- [ ] å¥åº·æ£€æŸ¥é€šè¿‡
- [ ] æ•°æ®åº“æ–‡ä»¶åˆ›å»ºåœ¨æ­£ç¡®ä½ç½®

### âœ… ç«¯å£åˆ‡æ¢éªŒè¯
- [ ] ç«¯å£å ç”¨æ—¶è‡ªåŠ¨åˆ‡æ¢
- [ ] çª—å£ä»èƒ½æ­£å¸¸æ‰“å¼€
- [ ] æ—¥å¿—è®°å½•å®é™…ç«¯å£

### âœ… æ•°æ®è·¯å¾„éªŒè¯
- [ ] æ•°æ®åº“è·¯å¾„ï¼š`%APPDATA%\warehouse-app\warehouse.db`
- [ ] æ—¥å¿—è·¯å¾„ï¼š`%APPDATA%\warehouse-app\logs\`

### âœ… å¸è½½éªŒè¯
- [ ] å¸è½½æˆåŠŸ
- [ ] ç”¨æˆ·æ•°æ®ä¿ç•™

---

## æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: æ„å»ºå¤±è´¥ - rebuild:native å¤±è´¥

**ç—‡çŠ¶**ï¼š`npm run rebuild:native` æŠ¥é”™

**è§£å†³æ–¹æ¡ˆ**ï¼š
```powershell
# æ£€æŸ¥ Electron ç‰ˆæœ¬
npm list electron
# åº”è¯¥æ˜¾ç¤º: electron@27.3.11

# æ‰‹åŠ¨é‡å»º
npm run rebuild:native

# å¦‚æœä»ç„¶å¤±è´¥ï¼Œæ£€æŸ¥ Visual Studio Build Tools æ˜¯å¦å®‰è£…
```

### é—®é¢˜ 2: åº”ç”¨å¯åŠ¨å¤±è´¥ - MODULE_NOT_FOUND

**ç—‡çŠ¶**ï¼šåº”ç”¨å¯åŠ¨æ—¶æŠ¥ `Cannot find module 'better-sqlite3'`

**åŸå› **ï¼šnative æ¨¡å—æœªæ­£ç¡® rebuild

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. é‡æ–°æ„å»ºï¼š`npm run rebuild:native`
2. é‡æ–°æ‰“åŒ…ï¼š`npm run dist:win`

### é—®é¢˜ 3: çª—å£æ— æ³•æ‰“å¼€

**ç—‡çŠ¶**ï¼šåº”ç”¨å¯åŠ¨ä½†çª—å£ä¸æ˜¾ç¤º

**æ£€æŸ¥**ï¼š
1. æŸ¥çœ‹æ—¥å¿—ï¼š`%APPDATA%\warehouse-app\logs\app-*.log`
2. æ£€æŸ¥åç«¯æ˜¯å¦å¯åŠ¨
3. æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨

### é—®é¢˜ 4: æ•°æ®åº“è·¯å¾„é”™è¯¯

**ç—‡çŠ¶**ï¼šæ•°æ®åº“æ–‡ä»¶ä¸åœ¨ `%APPDATA%\warehouse-app\`

**æ£€æŸ¥**ï¼š
1. æŸ¥çœ‹æ—¥å¿—ä¸­çš„"ç”¨æˆ·æ•°æ®ç›®å½•"
2. ç¡®è®¤ç¯å¢ƒå˜é‡ `WAREHOUSE_USER_DATA` æ˜¯å¦æ­£ç¡®ä¼ é€’

---

**æ‰€æœ‰éªŒè¯æ­¥éª¤å®Œæˆï¼** âœ…
